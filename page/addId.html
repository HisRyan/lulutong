<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¿¡æ¯å½•å…¥</title>
    <link rel="stylesheet" href="/css/homeCard.css">
    <link rel="stylesheet" href="/css/addId.css">
    <link rel="stylesheet" href="/Mdate/needcss/Mdate.css">
    <script src="/js/regular.js"></script>
    <script src="/js/ajax.js"></script>
    <!-- <script src="/Mdate/iScroll.js"></script>
    <script src="/Mdate/Mdate.js"></script> -->


</head>

<body>

    <div>

        <div class="wrap">
            <ul class="plan">
                <li>
                    <div class="left ">1</div>
                    <div class="right">å¡å·å¯†ç </div>
                </li>
                <li>
                    <div class="left">2</div>
                    <div class="right">é˜…è¯»æ¡æ¬¾</div>
                </li>
                <li>
                    <div class="left check">3</div>
                    <div class="right">ä¿¡æ¯å¡«å†™</div>
                </li>
                <li>
                    <div class="left">4</div>
                    <div class="right">å®Œæˆæ¿€æ´»</div>
                </li>
            </ul>
        </div>


        <div class="titleId">
            <span>å¡å·:</span><span class="cardid"></span>
        </div>
        <div class="range">
            è¢«ä¿äººå¹´é¾„åŒºé—´ï¼š18è‡³70å‘¨å²
        </div>

        <div class="center">
            <p class="title">æŠ•ä¿äººä¿¡æ¯</p>

            <p class="list">
                å§“å
                <input class="test" type="text" name="name" id=tb_name>
                <span class="cktb_name check2"></sapn>
            </p>
            <p class="list">
                èº«ä»½è¯
                <select name="type" id="tb_type">
                    <option value="å±…æ°‘èº«ä»½è¯">å±…æ°‘èº«ä»½è¯</option>
                    <option value="å†›å®˜è¯">å†›å®˜è¯</option>
                    <option value="æ¸¯æ¾³å°å¤§é™†é€šè¡Œè¯">æ¸¯æ¾³å°å¤§é™†é€šè¡Œè¯</option>
                    <option value="å¤–å›½äººæ°¸ä¹…å±…ç•™è¯">å¤–å›½äººæ°¸ä¹…å±…ç•™è¯</option>
                    <option value="æŠ¤ç…§">æŠ¤ç…§</option>
                </select>
            </p>
            <p class="list">
                è¯ä»¶å·ç 
                <input class="test" type="text" id="tb_perid">
                <span class="cktb_perid check2"></sapn>
            </p>
            <p class="list">
                æ‰‹æœºå·ç 
                <input class="test" type="text" id="tb_pho">
                <span class="cktb_pho check2"></sapn>
            </p>
            <p class="list">
                æ€§åˆ«
                <select id="tb_gender">
                    <option value="m">ç”·</option>
                    <option value="f">å¥³</option>
                </select>
            </p>
            <p class="list">
                å‡ºç”Ÿæ—¥æœŸ
                <input class="test" type="date" id="tb_date">
            </p>

            <p class="list">
                ç”µå­é‚®ä»¶
                <input class="test" type="text" id="tb_email">
                <span class="cktb_email check2"></sapn>
            </p>

            <p class="list">
                è”ç³»åœ°å€
                <input class="test" type="text" id="tb_address">
            </p>
        </div>

        <div class="center">
            <p class="title">è¢«æŠ•ä¿äººä¿¡æ¯</p>
            <p class="list">
                æ˜¯æŠ•ä¿äºº
                <select id="relation">
                    <option value="" disabled selected hidden>-è¯·é€‰æ‹©-</option>
                    <option value="self">æœ¬äºº</option>
                    <option value="par">çˆ¶æ¯</option>
                    <option value="mate">é…å¶</option>
                    <option value="sons">å­å¥³</option>
                    <option value="other">å…¶ä»–</option>
                </select>
            </p>
            <p class="list">
                å§“å
                <input class="test" type="text" name="name" id=bb_name>
                <span class="ckbb_name check2"></sapn>
            </p>
            <p class="list">
                èº«ä»½è¯
                <select name="type" id="bb_type">
                    <option value="å±…æ°‘èº«ä»½è¯">å±…æ°‘èº«ä»½è¯</option>
                    <option value="å†›å®˜è¯">å†›å®˜è¯</option>
                    <option value="æ¸¯æ¾³å°å¤§é™†é€šè¡Œè¯">æ¸¯æ¾³å°å¤§é™†é€šè¡Œè¯</option>
                    <option value="å¤–å›½äººæ°¸ä¹…å±…ç•™è¯">å¤–å›½äººæ°¸ä¹…å±…ç•™è¯</option>
                    <option value="æŠ¤ç…§">æŠ¤ç…§</option>
                </select>
            </p>
            <p class="list">
                è¯ä»¶å·ç 
                <input class="test" type="text" id="bb_perid">
                <span class="ckbb_perid check2"></sapn>
            </p>
            <p class="list">
                æ‰‹æœºå·ç 
                <input class="test" type="text" id="bb_pho">
                <span class="ckbb_pho check2"></sapn>
            </p>
            <p class="list">
                æ€§åˆ«
                <select id="bb_gender">
                    <option value="m">ç”·</option>
                    <option value="f">å¥³</option>
                </select>
            </p>
            <p class="list">
                å‡ºç”Ÿæ—¥æœŸ
                <input class="test" type="date" id="bb_date">
            </p>

            <p class="list">
                ç”µå­é‚®ä»¶
                <input class="test" type="text" id="bb_email">
                <span class="ckbb_email check2"></sapn>
            </p>

            <p class="list">
                è”ç³»åœ°å€
                <input class="test" type="text" id="bb_address">
            </p>
        </div>

        <div class="center foot">
            <p class="title">å—ç›Šäººä¿¡æ¯</p>
            <p class="benefit">å—ç›Šäººä¸ºæ³•å®šç»§æ‰¿äºº</p>
            <p class="time">ç”Ÿæ•ˆæœ‰æ•ˆæœŸé€‰æ‹©ï¼š<span class="start">2020-07-10</span>è‡³<span class="end">2020-11-10</span></p>
            <p><span>ç”Ÿæ•ˆæ—¶æœŸ</span> <input type="text" id="dateSelectorTwo" placeholder="è¯·å¡«å†™ï¼šxxxx-xx-xx">
                <button type="button" id="dateShowBtn">é€‰æ‹©æ—¥æœŸ</button></p>

            <div class="but more">
                ä¸‹ä¸€æ­¥
            </div>
            <div class="but exit">
                å®‰å…¨é€€å‡º
            </div>
        </div>
    </div>
</body>

<script>
    //æ—¥æœŸæ’ä»¶
    // new Mdate("dateShowBtn", {
    //     acceptId: "dateSelectorTwo",
    //     beginYear: "2002",
    //     beginMonth: "10",
    //     beginDay: "24",
    //     endYear: "2017",
    //     endMonth: "1",
    //     endDay: "1",
    //     format: "-"
    // })
    var id = sessionStorage.getItem('id');
    var cardidDOM = document.querySelector(".cardid");
    cardidDOM.textContent = id;
    var typeDOM = document.querySelector("#type");
    var rg = new RegQ();
    var relationDOM = document.querySelector("#relation");
    var tbnameflag = 0;
    var bbnameflag = 0;

    var tbidflag = 0;
    var bbidflag = 0;

    var tbemailflag = 0;
    var bbemailag = 0;

    var tbnameflag = 0;
    var tbphoflag = 0;

    var bbphoflag = 0;
    var tbnameflag = 0;

    //é€‰å–å…³ç³»é€‰æ‹©ä¸­çš„å†…å®¹
    relationDOM.addEventListener("change", function () {
        // var index = relationDOM.selectedIndex
        // let retype = relationDOM.options[index].value;
        // console.log(retype);
        let retype = relationDOM.value;
        console.log(retype);
        if (retype == "self") {
            //å¤åˆ¶å§“å
            copy("#tb_name", "#bb_name");

            //å¤åˆ¶å¡å·
            copy("#tb_perid", "#bb_perid");

            //å¤åˆ¶è¯ä»¶ç±»å‹
            copy("#tb_type", "#bb_type");

            //å¤åˆ¶æ€§åˆ«
            copy("#tb_gender", "#bb_gender");

            //å¤åˆ¶ç”Ÿæ—¥
            copy("#tb_date", "#bb_date");

            //å¤åˆ¶ç”µå­é‚®ä»¶
            copy("#tb_email", "#bb_email")

            //å¤åˆ¶æ‰‹æœºå·ç 
            copy("#tb_pho", "#bb_pho")

            //å¤åˆ¶æ‰‹æœºå·ç 
            copy("#tb_address", "#bb_address")
        }
    })


    //åˆ¤æ–­å§“ååˆé€‚æ˜¯å¦æ­£ç¡®

    ckpername("#tb_name", ".cktb_name");
    ckpername("#bb_name", ".ckbb_name");

    //åˆ¤æ–­è¯ä»¶å·ç æ˜¯å¦ç¬¦åˆè§„èŒƒ
    ckperid("#tb_perid", ".cktb_perid");
    ckperid2("#bb_perid", ".ckbb_perid");

    //åˆ¤æ–­ç”µå­é‚®ä»¶æ˜¯å¦ç¬¦åˆè§„èŒƒ
    ckemail("#tb_email", ".cktb_email");
    ckemail("#bb_email", ".ckbb_email");

    //åˆ¤æ–­æ‰‹æœºå·ç æ˜¯å¦ç¬¦åˆè§„èŒƒ
    ckpho("#tb_pho", ".cktb_pho");
    ckpho("#bb_pho", ".ckbb_pho");




    function ckpername(option, option2) {
        let flag = 0;
        var tb_nameDOM = document.querySelector(option);
        var cktb_nameDOM = document.querySelector(option2);
        tb_nameDOM.addEventListener('blur', function () {
            let tbname = tb_nameDOM.value;
            if (rg.pername(tbname)) {
                flag += 1;

            } else if (rg.nonull(tbname)) {
                cktb_nameDOM.innerHTML = "";
                flag = 0;
            } else {
                cktb_nameDOM.innerHTML = `<span class="idFalse">ğŸ˜¥æ ¼å¼é”™è¯¯</span>`;
                flag = 0;
            }
        })
        tb_nameDOM.addEventListener('focus', function () {
            cktb_nameDOM.innerHTML = "";
        })
        console.log(flag);
        return flag;
    }

    function ckemail(option, option2) {
        let flag = 0;
        var tb_nameDOM = document.querySelector(option);
        var cktb_nameDOM = document.querySelector(option2);
        tb_nameDOM.addEventListener('blur', function () {
            let tbname = tb_nameDOM.value;
            if (rg.mail(tbname)) {
                flag = 1;
            } else if (rg.nonull(tbname)) {
                cktb_nameDOM.innerHTML = "";
                flag = 0;
            } else {
                cktb_nameDOM.innerHTML = `<span class="idFalse">ğŸ˜¥é‚®ä»¶æ ¼å¼é”™è¯¯</span>`;
                flag = 0;
            }
        })
        tb_nameDOM.addEventListener('focus', function () {
            cktb_nameDOM.innerHTML = "";
        })
        return flag;
    }

    function ckperid(option, option2) {
        let flag = 0;
        var tb_nameDOM = document.querySelector(option);
        var cktb_nameDOM = document.querySelector(option2);
        tb_nameDOM.addEventListener('blur', function () {
            let tbname = tb_nameDOM.value;
            if (rg.idcard(tbname)) {
                let tbperid = document.querySelector("#tb_perid").value;
                let idsex = tbperid.slice(16, 17);
                let iddate = tbperid.slice(6, 10) + "-" + tbperid.slice(10, 12) + "-" + tbperid.slice(12, 14);
                if (idsex % 2 == 0) {
                    document.querySelector('#tb_gender').value = "f";
                }
                document.querySelector("#tb_date").value = iddate;

            } else if (rg.nonull(tbname)) {
                cktb_nameDOM.innerHTML = "";
                flag = 0;
            } else {
                cktb_nameDOM.innerHTML = `<span class="idFalse">ğŸ˜¥èº«ä»½è¯æ ¼å¼é”™è¯¯</span>`;
                flag = 0;
            }
        })
        tb_nameDOM.addEventListener('focus', function () {
            cktb_nameDOM.innerHTML = "";
        })
        return flag;
    }

    function ckperid2(option, option2) {
        let flag = 0;
        console.log(1);
        var tb_nameDOM = document.querySelector(option);
        var cktb_nameDOM = document.querySelector(option2);
        tb_nameDOM.addEventListener('blur', function () {
            let tbname = tb_nameDOM.value;
            if (rg.idcard(tbname)) {
                let bbperid = document.querySelector(option).value;
                console.log(bbperid.slice(16, 17));
                let idsex = bbperid.slice(16, 17);
                let iddate = bbperid.slice(6, 10) + "-" + bbperid.slice(10, 12) + "-" + bbperid.slice(12, 14);
                if (idsex % 2 == 0) {
                    document.querySelector('#bb_gender').value = "f";
                }
                document.querySelector("#bb_date").value = iddate;

            } else if (rg.nonull(tbname)) {
                cktb_nameDOM.innerHTML = "";
                flag = 0;
            } else {
                cktb_nameDOM.innerHTML = `<span class="idFalse">ğŸ˜¥èº«ä»½è¯æ ¼å¼é”™è¯¯</span>`;
                flag = 0;
            }
        })
        tb_nameDOM.addEventListener('focus', function () {
            cktb_nameDOM.innerHTML = "";
        })
        return flag;
    }


    function ckpho(option, option2) {
        let flag = 0;
        var tb_nameDOM = document.querySelector(option);
        var cktb_nameDOM = document.querySelector(option2);
        tb_nameDOM.addEventListener('blur', function () {
            let tbname = tb_nameDOM.value;
            if (rg.phone(tbname)) {
                flag = 1;
                let percarid = document.querySelector("#tb_perid").value;
                console.log(percarid);
            } else if (rg.nonull(tbname)) {
                cktb_nameDOM.innerHTML = "";
                flag = 0;
            } else {
                cktb_nameDOM.innerHTML = `<span class="idFalse">ğŸ˜¥æ‰‹æœºå·æ ¼å¼é”™è¯¯</span>`;
                flag = 0;
            }
        })
        tb_nameDOM.addEventListener('focus', function () {
            cktb_nameDOM.innerHTML = "";
        })
        return flag;
    }

    function copy(option, option2) {
        let name = document.querySelector(option).value;
        document.querySelector(option2).value = name;
        document.querySelector(option2).disabled = "true";

    }


    //ç‚¹å‡»ä¸‹ä¸€æ­¥ å…ˆæ£€æµ‹æ•°æ®æ˜¯å¦è§„èŒƒ
    var moreDOM = document.querySelector(".more");
    moreDOM.addEventListener("click", function () {
        console.log(ckpername("#tb_name", ".cktb_name"));
        console.log(ckperid("#tb_perid", ".cktb_perid"));
        console.log(ckemail("#tb_email", ".cktb_email"));
        // if (ckpername("#tb_name", ".cktb_name") == 0) {
        //     document.querySelector("#tb_name").scrollIntoView();
        //     return;
        // }
        // if (ckperid("#tb_perid", ".cktb_perid" == 0)) {
        //     document.querySelector("#tb_perid").scrollIntoView();
        //     return;
        // }
        // if (ckemail("#tb_email", ".cktb_email") == 0) {
        //     document.querySelector("#tb_email").scrollIntoView();
        //     return;
        // }
        // if (!ckpho("#tb_pho", ".cktb_pho") == 0) {
        //     document.querySelector("#tb_pho").scrollIntoView();
        //     return;
        // } else {
        let tb_name = document.querySelector("#tb_name").value;
        let tb_type = document.querySelector("#tb_type").value;
        let tb_gender = document.querySelector("#bb_gender").value;
        let tb_date = document.querySelector("#tb_date").value;
        let tb_perid = document.querySelector("#tb_perid").value;
        let tb_email = document.querySelector("#tb_email").value;
        let tb_pho = document.querySelector("#tb_pho").value;
        let tb_address = document.querySelector("#tb_address").value;
        let bb_name = document.querySelector("#bb_name").value;
        let bb_type = document.querySelector("#bb_type").value;
        let bb_gender = document.querySelector("#bb_gender").value;
        let bb_date = document.querySelector("#bb_date").value;
        let bb_perid = document.querySelector("#bb_perid").value;
        let bb_email = document.querySelector("#bb_email").value;
        let bb_pho = document.querySelector("#bb_pho").value;
        let bb_address = document.querySelector("#bb_address").value;
        myajax({
            "url": "/php/addId.php",
            "arg": {
                "id": id,
                "tb_name": tb_name,
                "tb_type": tb_type,
                "tb_gender": tb_gender,
                "tb_date": tb_date,
                "tb_perid": tb_perid,
                "tb_email": tb_email,
                "tb_pho": tb_pho,
                "tb_address": tb_address,

                "bb_name": bb_name,
                "bb_type": bb_type,
                "bb_gender": bb_gender,
                "bb_date": bb_date,
                "bb_perid": bb_perid,
                "bb_email": bb_email,
                "bb_pho": bb_pho,
                "bb_address": bb_address,
            },
            "success": function (re) {
                if (re.code == 1) {
                    window.location.href = `success.html`;
                } else {

                }
            }

        });

    })
</script>

</html>